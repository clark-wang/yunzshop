{template 'common/header'}
<title>{if $_GPC["init_money"]}{$_GPC["init_money"]}元专区{else}全部专区{/if}</title>
<style type="text/css">

body {margin:0px; width:100%; height:100%; background:#efefef; color:#fff; }

    .main {height:100%; width:100%; background:#fff; }
    .main .category {height:100%; width:60%; background:rgba(0,0,0,0.8);  position:fixed; left:-60%; top:0; z-index:9999;overflow-y: auto;}
    .main .category .title {height:44px; width:100%; background:rgba(0,0,0,0.2); line-height:44px; font-size:16px; color:#fff; text-align:center;}
    .main .category .all {height:auto; width:80%; padding:10px 10%; color:#fff;}
    .main .category .all p {height:auto; width:100%; font-size:14px; line-height:20px; padding:0px; margin:0px;}
    .main .category .all a{text-decoration: none}
   .main .category .all p.category_item { padding-top:10px;}
    .main .category .all p.child {height:auto; width:100%; font-size:14px; line-height:20px;  padding-left:10px;padding-top:10px;}
    .main .category .all p.third {height:auto; width:100%; font-size:14px; line-height:20px;  padding-left:20px;padding-top:10px;}
    .main .category .all span {height:auto; width:95%; margin-left:5%; margin-bottom:10px; font-size:16px; line-height:20px; padding:0px;}

.main .page {width:100%; background:#eee; }
.main .page .topbar {height:28px; width:100%; background:#f9f9f9; padding:8px 0;}
.main .page .topbar .list1 {height:28px; width:10%; float:left; margin-left:3%; line-height:28px; font-size:24px; text-align:left; color:#999;}
.main .page .topbar .name {height:28px; width:54%; padding-left:10%; margin:auto; text-align:center; float:left; font-size:16px; line-height:28px; color:#666;}
.main .page .topbar .sort {height:28px; width:10%; float:right; font-size:18px; line-height:28px; padding-top:5px; text-align:right; color:#999;}
.main .page .goods {height:auto; width:98%; padding:0 1%; margin-top:5px; float:left;}
.main .page .goods .good {width: 50%;box-sizing: border-box;float: left;    padding: 8px 4px 4px 8px;}
.main .page .goods .good img {width:100%; }
.main .page .goods .good .nostock { position: absolute;bottom:20px;right:0px; width:30%;height:30%;z-index: 999;}
.main .page .goods .good .nostock img { max-width: 50px}
.main .page .goods .good .name {height:42px; width:100%; font-size:14px; color:#333333; line-height:22px;overflow:hidden; padding-bottom:5px;}
.main .page .goods .good .tishi {overflow: hidden; height:16px; line-height:16px; width:100%; font-size:14px; color:#a59d9d}
.main .page .goods .good .tishi span {height:auto; width:auto; padding:0 6px; color:#a59d9d; font-size:12px; border-radius:5px;}
.main .page .copyright {height:40px; width:100%; text-align:center; line-height:40px; font-size:12px; color:#999; margin-top:10px;float:left;}


#fenye{clear:both;margin:15px 0;height:35px; text-align:center; }
#fenye table{ width:100%}
#fenye img{ vertical-align:inherit}
#fenye a,#fenye span{text-decoration:none; font-size:14px;height:30px;display:inline-block; text-align:center; 
line-height:30px;color:#666;border: 1px solid #ccc;padding:0 10px; font-size:12px; margin:0 2px;background:#fff; border-radius:3px; }
#fenye a.curr{background-color: #EFEFEF; cursor:default;}
#fenye a:hover{color:#333; background-color: #EFEFEF; }
#fenye span em{ margin-left:5px;}
.head a{ text-decoration:none}
.pagination{display:inline-block;padding-left:0;margin:20px auto;border-radius:4px;text-align: center;width:100%;}.pagination>li{display:inline-block;}.pagination>li>a,.pagination>li>span{position:relative;float:left;padding:6px 12px;margin-left:-1px;line-height:1.42857143;color:#666;text-decoration:none;background-color:#fff;border:1px solid #ddd}.pagination>li:first-child>a,.pagination>li:first-child>span{margin-left:0;border-top-left-radius:4px;border-bottom-left-radius:4px}.pagination>li:last-child>a,.pagination>li:last-child>span{border-top-right-radius:4px;border-bottom-right-radius:4px}.pagination>li>a:hover,.pagination>li>span:hover,.pagination>li>a:focus,.pagination>li>span:focus{color:#2a6496;background-color:#eee;border-color:#ddd}.pagination>.active>a,.pagination>.active>span,.pagination>.active>a:hover,.pagination>.active>span:hover,.pagination>.active>a:focus,.pagination>.active>span:focus{z-index:2;cursor:default;background-color:#EFEFEF;}.pagination>.disabled>span,.pagination>.disabled>span:hover,.pagination>.disabled>span:focus,.pagination>.disabled>a,.pagination>.disabled>a:hover,.pagination>.disabled>a:focus{color:#777;cursor:not-allowed;background-color:#fff;border-color:#ddd}.pagination-lg>li>a,.pagination-lg>li>span{padding:10px 16px;font-size:18px}.pagination-lg>li:first-child>a,.pagination-lg>li:first-child>span{border-top-left-radius:6px;border-bottom-left-radius:6px}.pagination-lg>li:last-child>a,.pagination-lg>li:last-child>span{border-top-right-radius:6px;border-bottom-right-radius:6px}.pagination-sm>li>a,.pagination-sm>li>span{padding:5px 10px;font-size:12px}.pagination-sm>li:first-child>a,.pagination-sm>li:first-child>span{border-top-left-radius:3px;border-bottom-left-radius:3px}.pagination-sm>li:last-child>a,.pagination-sm>li:last-child>span{border-top-right-radius:3px;border-bottom-right-radius:3px}.pager{padding-left:0;margin:20px 0;text-align:center;list-style:none}.pager li{display:inline}.pager li>a,.pager li>span{display:inline-block;padding:5px 14px;background-color:#fff;border:1px solid #ddd;border-radius:15px}.pager li>a:hover,.pager li>a:focus{text-decoration:none;background-color:#eee}.pager .next>a,.pager .next>span{float:right}.pager .previous>a,.pager .previous>span{float:left}.pager .disabled>a,.pager .disabled>a:hover,.pager .disabled>a:focus,.pager .disabled>span{color:#777;cursor:not-allowed;background-color:#fff}

    #list_loading { width:94%;padding:10px;color:#666;text-align: center;float:right;}
    .list_no {height:100px; width:100%; margin:50px 0px 60px; color:#ccc; font-size:12px; text-align:center;}
    .list_no_menu {height:40px; width:50%; text-align:center;margin:auto;}
    .list_no_nav {height:38px; padding:5px;background:#eee; border:1px solid #d4d4d4; border-radius:5px; text-align:center; line-height:38px; color:#666;}


div.addinfo{height:18px;}
.label-waring {
    font-size: 12px;
    line-height: 14px;
    padding: 1px 5px;
    display: inline-block; 
    background-color: #fd6801;
    color: #fff;
}
.tint-gray {
    color: #ccc;
}
.f12 {
    font-size: 12px;
    line-height: 14px;
}

.progress-bar {
    margin-bottom: 5px;
    position: relative;
    width: 100%;
    height: 8px;
    z-index: 10;
    -webkit-border-radius: 4px;
    border-radius: 4px;
    font-size: 0;
    line-height: 0;
    background: #e04512;
    background: -webkit-gradient(linear,left top,right top,from(#fcc150),to(#e04512));
    background: -webkit-linear-gradient(left,#fcc150,#e04512);
    background: linear-gradient(to right,#fcc150,#e04512);
}
.bg {
    display: block;
    width: 101%;
    height: 8px;
    position: absolute;
    z-index: 11;
    background-color: #d8d8d8;
    right: -1px;
    -webkit-border-radius: 0 4px 4px 0;
    border-radius: 0 4px 4px 0;
}
.btns {
    text-align: center;
}
a, ins {
    text-decoration: none;
}
.buy {
    display: inline-block;
    width: 80%;
    height: 28px;
    background-color: #d91d37;
    color: #fff;
    -webkit-border-radius: 2px;
    border-radius: 2px;
    font-size: 14px;
    line-height: 28px;
    text-align: center;
    font-weight: normal;
    margin: 6px 0 2px
}
</style>

<div id='container'></div>
<script id='tpl_main' type='text/html'>
  <div class="main">
    <div id='category_container'></div>   
      <div class='page'>
          <!--排序div-->
          <!--topbar-->
          <div class="topbar">
                <div class="list1">
                  <i class="iconfont icon-list-ul" style="font-size: 22px"></i>
          
                </div>
            <div class="name">{if $_GPC["init_money"]}{$_GPC["init_money"]}元专区{else}全部专区{/if}</div>
          </div>

          <!--商品列表-->
          <div class="goods">
              <div id='goods_container'></div>
          </div>
          <div class="copyright">版权所有 © {if !empty($set['copyright'])}{$set['copyright']}{else}{$_W['account']['name']}{/if}</div>
      </div>
      
  </div>
</script>

<script id='tpl_goods_list' type='text/html'>
  <form action="" method="post" id="goodsform">
    <input type="hidden" name="i" value="{$_W['uniacid']}">
    <input type="hidden" name="c" value="{$_GPC['c']}">
    <input type="hidden" name="do" value="{$_GPC['do']}">
    <input type="hidden" name="m" value="{$_GPC['m']}">
    <input type="hidden" name="p" value="{$_GPC['p']}">

    <input type="hidden" id="init_money" name="init_money" value="{$_GPC['init_money']}">
  </form>
  {if $goods}
    {loop $goods $g}
      <div class="good" data-goodsid="{$g['good_id']}" data-periodnum="{$g['period_num']}" style="position:relative;">
     
    		<div class="goods-img">
            <img src="{$g['thumb']}">
    		</div>
    		<div class="goods-cont">
            <div class="name">{$g['title']} </div>

            <div class="progress-bar" >
              <span class="bg" style="width:{$g['shengyu']}%"></span>
            </div>
            <div class="tishi">
              <span>{$g['zong_codes']}</span><span style="float: right;color:#d91d37">{$g['shengyu_codes']} </span>
            </div>
            <div class="tishi">
              <span>总需</span><span style="float: right;text-align: right;">剩余</span>
            </div>
    		</div>


        <div class="btns">
          <a class="buy" data-productname="{$g['title']} "  data-productid="{$g['good_id']}" href="javascript:;">立即参与</a>
        </div>
      </div>
    {/loop}
    {$pager}
  {else}
  <div class="list_no"><i class="fa fa-shopping-cart" style="font-size:100px;"></i><br><span style="line-height:18px; font-size:16px;">暂时没有相关商品</span><br>主人快去给我找点其他东西吧</div>
  {/if}

</script>
<script id='tpl_category_list' type='text/html'>
     <div class="category">
        <div class="title category_item" data-name='全部商品'><i class="iconfont icon-list-ul"></i> 全部分区<i class="fa fa-angle-left close" style="font-size:26px; float:right; line-height:44px; margin-right:20px;"></i></div>
        <div class="all">
        {loop $init_money $val}
          <p class='category_item' data-initmoney='{$val['init_money']}'><i class="fa fa-cart-plus"></i> {$val['init_money']}元专区</p>
        {/loop}
        </div>
    </div>
</script>
<script id='tpl_empty' type='text/html'>
  <div class="list_no"><i class="fa fa-shopping-cart" style="font-size:100px;"></i><br><span style="line-height:18px; font-size:16px;">暂时没有相关商品</span><br>主人快去给我找点其他东西吧</div>
  <div class="list_no_menu">
    <div class="list_no_nav" onclick="location.href='{php echo $this->createMobileUrl('shop')}'">看看其他的</div>
  </div>
</script>

<script language='javascript'>
    var loaded = false;
    var stop = true;
    var page = "{$_GPC['page']}";
    require(['tpl', 'core'], function (tpl, core) {
      function getGoods() {
          $('#goods_container').html(tpl('tpl_goods_list'));
          bindEvents();
      }
      function bindEvents() {
          $('.good img').each(function(){
             $(this).height($(this).width()); 
          });
          $('.good').unbind('click').click(function () {
            location.href = core.getUrl('shop/detail', {id: $(this).data('goodsid'), periodnum: $(this).data('periodnum'),my:'{$_GPC['my']}',indiana:'1'});
          });
      }
      function bindCategoryEvents(){
        $(".category .category_item").unbind('click').click(function(){
          var item = $(this);
          $("#init_money").val(item.data('initmoney'));
          $("#goodsform").submit();
        });  
      }

      $('#container').html(tpl('tpl_main'));
        $('.list1').click(function(){
             $(".sort_list").fadeOut(100);
             
             core.json('shop/util',{op:'category'}, function (json) {
                 category = json.result;
                 $('#category_container').append(tpl('tpl_category_list',category));
                 $(".category").animate({left:"0px"},200);
                 bindCategoryEvents();
              }, true);
        });
     getGoods();
    });
</script>
{php $show_copyright=true; $show_footer = true;}
{template 'common/footer'}

